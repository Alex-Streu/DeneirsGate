var customErrorAction="/Errors/CustomError",error500Action="/Errors/Error500",error400Action="/Errors/Error400",getUserTutorialAction="/Tutorial/GetUserTutorial",updateUserTutorialAction="/Tutorial/UpdateUserTutorial";function isEmpty(t){return null==t||null==t||""==t}function createGuid(){function t(t){var e=(Math.random().toString(16)+"000000000").substr(2,8);return t?"-"+e.substr(0,4)+"-"+e.substr(4,4):e}return t()+t(!0)+t(!0)+t()}function sortOptions(t){var e=$(`${t} option`),n=e.map(function(t,e){return{t:$(e).text(),v:e.value}}).get();n.sort(function(t,e){var n=t.t.toLowerCase(),a=e.t.toLowerCase();return n>a?1:n<a?-1:0}),e.each(function(t,e){e.value=n[t].v,$(e).text(n[t].t)})}function promptDelete(t){$("#deleteContentBtn").attr("onclick",t),$("#deleteContentModal").modal("show")}function loadEncounter(t){null==t&&(t=null),isEmpty(t)||1!=t.IsEdited?$("#encounterBody").load(`/Event/_Encounter?id=${t}`,function(t,e,n){$("#encounterModal").modal("show")}):$("#encounterBody").load("/Event/_EncounterPost",t,function(t,e,n){$("#encounterModal").modal("show")})}function ajaxPost(t,e,n,a,i){null==n&&(n=defaultCompleteFunction),null==a&&(a=defaultErrorFunction),null==i&&(i=defaultCompleteFunction),$.ajax({type:"POST",url:e,data:JSON.stringify(t),dataType:"json",contentType:"application/json",success:n,error:a,complete:i})}function defaultErrorFunction(t){t.responseText.indexOf("<!DOCTYPE html>")>-1&&(window.location=error500Action),Notiflix.NotifyContent.Failure(t.responseText)}function defaultCompleteFunction(){}function suggest(t,e,n){ajaxPost({Type:e},"/Suggestion/GenerateSuggestion",function(e){e.success?null==n?$(`#${t}`).val(e.data):n.setData(e.data):Notiflix.NotifyContent.Failure(e.message)})}$(".modal").on("shown.bs.modal",function(){$(this).find("[autofocus]").focus()}),AddAntiForgeryToken=function(t){return t.__RequestVerificationToken=$("#__AjaxAntiForgeryForm input[name=__RequestVerificationToken]").val(),t},jQuery.fn.removeClassExcept=function(t){return this.each(function(){$(this).removeClass().addClass(t)})},$(".btn-suggestion").parent().mouseenter(function(){$(this).find(".btn-suggestion").show()}),$(".btn-suggestion").parent().mouseleave(function(){$(this).find(".btn-suggestion").hide()});var tutorialKey="",tutorialName="",tutorialEngine=null,tutorialEngineSteps=[];function initializeTutorial(){tutorialEngine=new EnjoyHint({onSkip:storeUserTutorial,onEnd:completeUserTutorial}),$("#helpBtn").show()}function setTutorialSteps(t){tutorialEngineSteps=t,tutorialEngine.set(t)}function getUserTutorial(t,e){tutorialName=t;var n=window.location.pathname.split("/"),a="";for(i=0;i<n.length&&(a+="/",!(n[i].indexOf("-")>-1&&"36"==n[i].length));i++)a+=n[i];var o={Route:a,Name:t};"true"!=Cookies.get(o.Route+o.Name)||null==e?ajaxPost(o,getUserTutorialAction,function(t){t.success?(tutorialKey=t.data.TutorialKey,t.data.IsComplete?null!=e&&e():(tutorialEngine.setCurrentStep(t.data.LastStep),tutorialEngine.resume())):Notiflix.NotifyContent.Failure(t.message)}):e()}function completeUserTutorial(){updateUserTutorial(!0,0)}function storeUserTutorial(){updateUserTutorial(!1,tutorialEngine.getCurrentStep())}function updateUserTutorial(t,e){var n=window.location.pathname.split("/");for(i=0;i<n.length&&("/",!(n[i].indexOf("-")>-1&&"36"==n[i].length));i++)n[i];ajaxPost({TutorialKey:tutorialKey,IsComplete:t,LastStep:e},updateUserTutorialAction,function(t){t.success||Notiflix.NotifyContent.Failure(t.message)})}$("#helpBtn").click(function(){initializeTutorial(),setTutorialSteps(tutorialEngineSteps),tutorialEngine.resume()}),$(document).on("click",".enjoyhint_close_btn",function(){completeUserTutorial()}),Number.prototype.clamp=function(t,e){return Math.min(Math.max(this,t),e)},$(".fancy-textarea textarea").focus(function(){$(this).parent().find("label").addClass("active")}),$(".fancy-textarea textarea").blur(function(){$(this).parent().find("label").removeClass("active")}),$(".fancy-dropdown select").focus(function(){$(this).parent().find("label").addClass("active")}),$(".fancy-dropdown select").blur(function(){$(this).parent().find("label").removeClass("active")}),$("body").on("click",".fancy-tab-item",function(){var t=$(this).data("tab"),e=$(this).parent().data("panes");$(`#${e}`).find(".fancy-tab-pane").each(function(){$(this).removeClass("active")}),$(this).parent().find(".fancy-tab-item").each(function(){$(this).removeClass("active")}),$(`#${t}`).addClass("active"),$(this).addClass("active")}),$(document).ready(function(){$(".fancy-switch").each(function(){"True"==$(this).data("val")&&$(this).find("input").attr("checked","checked")})});var uploadImageUtilityAction="/Utility/UploadImage/",deleteTempUtilityAction="/Utility/DeleteTemp/",saveTempImageUtilityAction="/Utility/SaveTempImage/",imageUploadCampaignKey=null;function uploadImage(t,e,n,a=!1){uploadImageExternal(t,e,n,$(t).parent().find("img"),a)}function uploadImageExternal(t,e,n,a,i=!1){var o=$(t).prop("files")[0];if(null!=o){var r=$(t).parent(),l=new FileReader;imageUploadCampaignKey=$(r).data("campaign"),l.onloadend=function(){var t=l.result,o=base64MimeType(t);if(null!=o){var u={CampaignKey:imageUploadCampaignKey,Folder:e,Name:n,File:t,FileType:o,IsTemp:i};$.ajax({type:"POST",url:uploadImageUtilityAction,data:JSON.stringify(u),dataType:"json",contentType:"application/json",processData:!1,success:function(t){t.success&&($(a).attr("src",t.imagePath.replace("~","")),$(r).find(".image-name").val(t.image),$(r).find(".image-name").change())},error:function(t){}})}},l.readAsDataURL(o)}}function base64MimeType(t){var e=null;if("string"!=typeof t)return e;var n=t.match(/data:([a-zA-Z0-9]+\/[a-zA-Z0-9-.+]+).*,.*/);n&&n.length&&(e=n[1]);var a=null;switch(e.replace("image/","")){case"png":a=".png";break;case"jpg":case"jpeg":a=".jpg"}return a}$(".upload-image .overlay").click(function(){$(this).parent().find('input[type="file"]').click()}),$(".image-upload").click(function(){$(this).parent().find('input[type="file"]').click()}),$('input.user-image[type="file"]').change(function(){null!=$(this).val()&&uploadImage(this,null,null,!0)}),$(window).on("unload",function(t){if(null!=imageUploadCampaignKey){var e="?campaignKey="+imageUploadCampaignKey;navigator.sendBeacon(deleteTempUtilityAction+e)}});